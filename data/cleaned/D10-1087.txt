Proceedings of the 2010 Conference on Empirical Methods in Natural Language Processing, pages 892–901,
MIT, Massachusetts, USA, 9-11 October 2010. c©2010 Association for Computational Linguistics
AutomaticCommaInsertionforJapaneseTextGeneration
MasakiMurata
GraduateSchoolof
InformationScience,
Nagoya University, Japan
murata@el.itc.nagoya-u.ac.jp
Tomohiro Ohno
GraduateSchoolof
InternationalDevelopment,
Nagoya University, Japan
ohno@nagoya-u.jp
ShigekiMatsubara
GraduateSchoolof
InformationScience,
Nagoya University, Japan
matubara@nagoya-u.jp
Abstract
This paper proposes a method for automat-
ically inserting commas into Japanese texts.
In Japanese sentences, commas play an im-
portant role in explicitly separating the con-
stituents,suchas wordsandphrases,of a sen-
tence. The method can be used as an ele-
mental technologyfor natural language gen-
eration such as speech recognition and ma-
chine translation, or in writing-supporttools
for non-native speakers. We categorized the
usages of commas and investigated the ap-
pearance tendency of each category. In this
method, the positions where commas should
be inserted are decided based on a machine
learning approach. We conducted a comma
insertion experimentusing a text corpus and
confirmedtheeffectivenessof ourmethod.
1 Introduction
In Japanesesentences,commasareinsertedto mark
wordboundariesthatmightbeotherwiseunclearbe-
causeJapaneseis a non-segmentedlanguage. They
arealsoinsertedatsharpsemanticboundariestoim-
prove the readabilityof a sentence. Whilethereis a
tendency aboutthe positionswherecommasshould
be insertedin a Japanesesentence,there is no clear
standard for these positions. Therefore, it is hard
for non-natives of Japanesesuchas foreignstudents
to insert commas properly, and the method for au-
tomaticcommainsertionis requiredto supportsen-
tence generationby such people. In addition, this
methodis expectedto be usefulfor improvingread-
abilityoftextsgeneratedbyautomaticspeechrecog-
nitionor machinetranslation.
This paper proposes a method for automatically
inserting commas into Japanese texts. There are
several usages of commas, and the positionsto in-
sert commas depend on these usages. Therefore,
we grouped the usages of commas into nine cate-
gories,andinvestigatedtheappearancetendency for
each category to find the effective features of ma-
chine learning by using Japanese newspaper arti-
cles. Basedon the analysisof commapositions,our
method decides whether or not to insert a comma
at each bunsetsu
1
boundaryin an input sentenceby
machinelearning.
We conductedan experimenton commainsertion
usingtheKyotoTextCorpus(KurohashiandNagao,
1998),andobtainedhigherrecallandprecisionthan
those of the baseline, leading us to confirm the ef-
fectivenessof ourmethod.
Thispaperis organizedas follows: The next sec-
tion presentsrelatedworks. Section3 gives prelim-
inary analyses. Section4 explainshow our comma
insertionmethodworks. An experimentanddiscus-
sionsarepresentedinSections5 and6,respectively.
2 RelatedWorks
Therehave beenmany investigationson commain-
sertion into output texts of speech recognitionsys-
tems to improve the readability(Christensenet al.,
2001; Kim and Woodland, 2001; Liu et al., 2006;
Shimizuet al.,2008). Theirmethodsinsertcommas
using pause informationof speakers, based on the
idea that a point at which a speaker takes a breath
partly correspondsto a point where a commais in-
serted. However, sincepauseinformationcannotbe
obtainedfromtexts,wecannotusethisapproachbe-
causeourtargetsarewrittentexts.
In addition, there have been some investigations
1
Bunsetsuis a linguisticunitin Japanesethatroughlycorre-
spondsto a basicphrasein English.A bunsetsuconsistsof one
independentwordandzeroor moreancillarywords.
892
on commainsertioninto non-Japanesewrittentexts
(White and Rajkumar, 2008; Guo et al., 2010). In
Japanese, there are several usages of commas, and
some usages are specificto Japanesedue to its lin-
guistic nature. Therefore, just adopting the above
mentioned methods, which have been developed
to process non-Japanese texts, is not sufficient to
enable high-qualitycomma insertioninto Japanese
sentences. Developmentof a method based on the
detailedanalysisof Japanesecommasis required.
Furthermore, there have been some investiga-
tionsoncommainsertionintoJapanesewrittentexts
(Hayashi,1992;Suzukiet al., 1995). Theseinvesti-
gationshave adoptedrule-basedmethods.However,
thenumberoftheirrulesisnotnecessarilysufficient,
andno quantitative evaluationhasbeenperformed.
3 AnalysesonCommaUsages
There have been several discussions on commas,
including the draft of “Kutou-hou (punctuation)”
made by Archives Division, Minister’s Secretariat,
Japanese Ministry of Education, Science and Cul-
ture in 1906. There are several usages of commas,
and dependingon the usage, the types of positions
where commasare insertedare different. First, we
examined some previous publications on commas
(Honda,1982; Inukai, 2002; Shogakukan’s editior-
ialdepartment,2007).Basedontheresultsoftheex-
amination,we classifiedthe usagesof commasinto
nine categories shown in Table 1. Here, commas
in Japanesesentencesand commasin English sen-
tences have some commonroles. In Japanesesen-
tences, some commashave the same roles as com-
mas in English sentences, but some commas have
rolesspecificto Japanesedueto its linguisticnature
such as “Japaneseis a non-segmentedlanguage”or
“Japanesehaskanjicharactersandkatakanacharac-
ters.”
In our study, positions where a comma should
be insertedare detectedby using machinelearning.
We investigated the Kyoto Text Corpusversion 4.0
(Kurohashi and Nagao, 1998) to find the effective
features. The Kyoto Text Corpus is a collectionof
Japanesearticles of Mainichinewspaper. We used
the articleson January1st and from January3rd to
11th in 1995 as the analysis data. Table 2 shows
the size of the data. The data had been manually
Table1: Categorizationof usagesof commas
# usageof comma
1 commasbetweenclauses
2 commasindicatingcleardependency relations
3 commasforavoidingreadingmistakes and
readingdifficulty
4 commasindicatingthesubject
5 commasinsertedaftera conjunctionor
adverbat thebeginningof a sentence
6 commasinsertedbetweenparallelwordsor
phrases
7 commasinsertedafteran adverbialphraseto
indicatetime
8 commasemphasizingtheadjacentword
9 other
Table2: Sizeof theanalysisdata
sentences 11,821
bunsetsus 117,501
characters 503,970
commas 16,595
characterspersentence 42.63
annotatedwith informationon morphologicalanal-
ysis, bunsetsusegmentationand dependency
2
anal-
ysis. Clauseboundariesweredetectedby the clause
boundary detection program CBAP (Kashiokaand
Maruyama,2004).
Out of all the inserted commas, only 1.43%
were insertedat positionswhich were not bunsetsu
boundaries. Therefore, we analyzed only commas
inserted at bunsetsu boundaries. Of 105,680 bun-
setsu boundaries, commas were inserted at 16,357
bunsetsu boundaries, that is, the rate of comma
insertion was 15.48%. In the following sections,
we focuson morphemes,clauseboundaries,depen-
dencyrelationandthenumberofcharactersbetween
commas, and investigate their relations with com-
mas.
3.1 CommasbetweenClauses
If a sentence consists of several clauses, inserting
a commabetweenclausesmakes clear the sentence
2
A dependency in a Japanesesentenceis a modificationre-
lationin whicha modifierbunsetsudependsona modifiedbun-
setsu. Thatis, the modifierbunsetsuand the modifiedbunsetsu
workas a modifieranda modifyee,respectively.
893
Table3: Ratesofcommainsertionaccordingtotheclause
boundarytype
typeof clauseboundary ratioof comma
insertion(%)
topicalizedelement-wa 16.94 (1,446/8,536)
adnominalclause 0.72 (43/5,960)
continuousclause 84.57 (2,685/3,175)
compoundclause-te 23.31 (394/1,690)
quotationalclause 4.40 (74/1,680)
supplementclause 17.53 (245/1,398)
discoursemarker 60.13 (650/1,081)
compoundclause-ga 93.85 (946/1,008)
compoundclause-de 84.52 (606/717)
conditionclause-to 81.66 (423/518)
structure. Therefore, a clause boundary is consid-
ered to be a strong candidateof a positionwhere a
comma is inserted. For example, in the following
sentence
3
:
• !"#$%&’()*+,-#./012345
6#7839:;<=%3>?5@ABC%D
(Toward lifting the sanctions imposed on Iraq by
UnitedNations, the aim seemsto be to requestfur-
ther cooperationfrom France,which has close ties
to Iraq.)
a commais insertedat the clauseboundaryrightaf-
ter the continuousclause “!"#$%&’()*
+,-#./(Towardliftingthesanctionsimposed
on Iraq by UnitedNations).” Like this example,the
sameusageof commasis seenin Englishas well.
In the analysis data, there existed 29,278 clause
boundaries excluding sentence breaks. Among
them, commas were inserted at 8,805 positions
(30.01%). The rate is higher than that of bunsetsu
boundaries. This indicatesthat commastend to be
insertedat clauseboundaries.
Weinvestigatedtherateofcommainsertionabout
114 types
4
of clauseboundaries. Table 3 shows the
top 10 clause boundary types accordingto the oc-
currence frequency, and the rates of comma inser-
3
We underlinedcommaswhichwe mentionedin the exam-
pleandthe correspondingpositionsin the translationof theex-
ample.
4
In ourresearch,weusedthetypesof clauseboundariesde-
fined by the Clause BoundaryAnnotationProgram(Kashioka
andMaruyama,2004).
g2913g9210g18174g6210g14039g18249g18305g18253g18314g18168g18170g18163g18159g18224g18246g18224g18167g18104g5876g8075g2902g18153g18203g2928g4444g18174g5073g4478g18175g18104g5500g7043g18171g18130g18181g18204g18166g18132g18203g18168g4000g6892
g18171g18104g4436g14260g18170g12578g14495g18194g5283g10010g18151g18166g18132g18203g18105
g894g47g374g3g4g400g349g258g853g449g346g349g272g346g3g271g286g272g381g373g286g400g3g258g3g272g286g374g410g286g396g3g381g296g3g410g346g286g3g336g396g381g449g410g346g3g381g296g3g410g346g286g3g449g381g396g367g282g853g3g410g346g286g3g400g410g396g381g374g336g3g393g396g286g400g286g374g272g286g3g381g296g3g18g346g349g374g258g3g374g381g410g3
g381g374g367g455g3g271g396g349g374g336g400g3g346g381g393g286g3g271g437g410g3g258g367g400g381g3g272g258g437g400g286g400g3g282g349g296g296g349g272g437g367g410g3g393g396g381g271g367g286g373g400g856g895
g18454g271g437g374g400g286g410g400g437 g18454g282g286g393g286g374g282g286g374g272g455g3g396g286g367g258g410g349g381g374
g2913g9210
g2146
g381g296g3g410g346g286g3
g449g381g396g367g282
g6210g14039g2221
g2277g2225g2286
g2140
g258g3g272g286g374g410g286g396g3
g381g296g3g410g346g286g3
g336g396g381g449g410g346
g2142g2135
g2131
g271g286g272g381g373g286g400
g2196g2218g2196
g2139
g349g374g3
g4g400g349g258
g5876g8075g2902
g2125g2175
g400g410g396g381g374g336
g2928g4444
g2146
g381g296g3
g18g346g349g374g258
g5073g4478
g2147
g393g396g286g400g286g374g272g286
g5500g7043
g2143
g346g381g393g286
g2102g2153g2176g2138
g2104g2175g2140g4000
g6892g2143
g374g381g410g3g381g374g367g455g3
g271g396g349g374g336g400
g4436g14260
g2142
g282g349g296g296g349g272g437g367g410
g12578g14495
g2166
g393g396g381g271g367g286g373g400
g5283g10010g2123
g2138g2104g2175
g272g258g437g400g286g400
Figure1: Commasmakingcleardependency relations
tion. In cases of “continuous clause” and “com-
pound clause-de,” the rates were higher than 84%.
On the other hand, in cases of “adnominalclause”
and “quotationalclause,” the rates were lower than
5%. Thismeansthatthelikelihoodsofcommainser-
tion are different accordingto the clause boundary
type.
3.2 CommasandDependencyStructure
Commashave a role to make dependency relations
clearer. Commas tend to be inserted right after a
bunsetsuthatdependson a distantbunsetsu. In Fig-
ure 1, although the bunsetsu “EFEG(in Asia)”
dependson the bunsetsu“HIJK5%(causes),”
if the commarightafterthe bunsetsu“EFEG(in
Asia)”is not inserted,the readersmightmistakenly
understandthat the bunsetsu “EFEG (in Asia)”
dependsonthenextbunsetsu“LMNO%(strong).”
To avoidthe mistake, the commais inserted.
In the analysisdata, there existed66,984bunset-
sus whichdependon the next bunsetsu. Amongthe
bunsetsuboundariesrightafterthem,2,302(3.44%)
werethepositionswherea commawas inserted.On
the other hand, in the case of a bunsetsu bound-
ary rightaftera bunsetsuwhichdoesnot dependon
the next bunsetsu, the rate of commainsertionwas
36.32%(14,055/38,696).
In addition, when the modifyeeof a bunsetsu is
located outside the clause containingthe bunsetsu,
i.e. to the right of the clauseend, commasare con-
sideredto bemorefrequentlyinsertedrightafterthe
bunsetsu because such bunsetsu causes more com-
plex dependency structure. The rate of comma in-
sertionrightaftersuchbunsetsuis 54.24%.
894
3.3 CommasforAvoidingReadingMistakes
andReadingDifficulty
Although, unlike English, Japanese is a non-
segmented language, word boundaries are easy to
detect because Japanese has three types of charac-
ters; hiragana characters,katakanacharacters,and
kanjicharacters.However, ifthesametypesofchar-
actersappearsequentially, readersmaymakearead-
ing mistake or feel difficulty in reading them. To
avoid such mistakes and difficulty, there is a usage
of commasspecificto Japanese.
In the following example, a comma is inserted
between two sequentially appearing words “PQ
(burned)”and “R(ashes)”bothof whichconsistof
onlykanjicharacters.
• STUV3WX;YZ[\]^_‘abc3d
ef#gVGPQ0R;ha3Hi#jKkl@
;m=%no@5pD(Heseemedtoacknowledge
thathehadcarriedthecorpseofMr. Kawasakitoan
acquaintancein Hanasaki, Katashina-mura,Tone-
gun, Gunma Prefecture, burned it and abandoned
itsashesin themountainforestin Katashina-mura.)
The comma was inserted because if there was no
comma, the word boundarywould become unclear
and reading difficulty would be caused. Among
2,409bunsetsuboundariesover whichkanjicharac-
tersappearedsequentially, commaswereinsertedat
2,188(90.83%)bunsetsuboundaries. In the case of
katakanacharacters,theratewas97.69%(211/216).
Commastendtobeinsertedatmostbunsetsubound-
aries if kanji charactersor katakana charactersse-
quentiallyappearover a boundary.
3.4 CommasIndicatingtheSubject
Commasare consideredto be insertedright after a
bunsetsu that represents the subject of a sentence.
For example,in Figure2, a commais insertedright
afterthebunsetsu“qrs(war)”toindicatethatthe
bunsetsuisthesubjectofthesentence.Here,wepay
attention to the clause boundary of the type “topi-
calizedelement-wa.” Theratethatcommaswerein-
sertedattheclauseboundaries“topicalizedelement-
wa” was 16.94%(1,446/8,536). This rate is almost
the same as that of bunsetsu boundaries. On the
otherhand,thecommasinsertedattheclausebound-
aries“topicalizedelement-wa” accountedfor8.84%
(1,446/16,357)of all theinsertedcommas.
g18233g18305g18282g18246g18224g18167g18174g14039g18132g6227g8518g18175g18104g18287g18241g18305g18210g14052g9422g18139g18201g13362g18150g18145g18104g5469g18210g7903g7169g18170g18169g18139g18201g14200g14259g18151g18166g18141g18159g18105
g894g4g3g367g381g374g336g3g449g258g396g3g349g374g3g18g258g373g271g381g282g349g258g346g258g400g3g364g286g393g410g3g258g449g258g455g3g68g286g364g381g374g336g3g296g396g381g373g3g258g3g282g286g448g286g367g381g393g373g286g374g410g853g3g258g374g282g3g346g258g400g3g349g400g381g367g258g410g286g282g3
g410g346g286g3g396g349g448g286g396g3g296g396g381g373g3g393g381g367g367g437g410g349g381g374g3g286g410g272g856g895
g2205g2277g2254g2218
g2196g2139g2146
g349g374g3
g18g258g373g271g381g282g349g258
g14039g2104
g367g381g374g336
g6227g8518
g2147
g449g258g396
g2259g2213g2277
g2182
g68g286g364g381g374g336
g14052g9422
g2111g2173
g296g396g381g373g3g258
g282g286g448g286g367g381g393g373g286g374g410
g13362g2122g2117
g346g258g400g3g364g286g393g410g3
g258g449g258g455
g5469g2182
g410g346g286g3g396g349g448g286g396
g7903g7169g2142g2141
g2111g2173
g296g396g381g373g3
g393g381g367g367g437g410g349g381g374g3g286g410g272g856
g14200g14259g2123
g2138g2113g2131
g346g258g400g3
g349g400g381g367g258g410g286g282
g18454g271g437g374g400g286g410g400g437 g18454g282g286g393g286g374g282g286g374g272g455g3g396g286g367g258g410g349g381g374
Figure2: Commainsertionat the clauseboundary“topi-
calizedelement-wa”
In the case of the clause boundary “topicalized
element-wa” right after a bunsetsu which does not
dependon the next bunsetsu(e.g., the bunsetsu“q
rs(war)” in Figure 2), the rate of comma inser-
tion was 20.71% (1,426/6,886). The rate is higher
than that of all the clause boundaries “topicalized
element-wa.” This shows that commas tend to be
especiallyinserted at the “topicalizedelement-wa”
right after bunsetsus which do not depend on the
next bunsetsu.
3.5 CommasafterConjunctionorAdverb
Commas tend to be inserted right after a conjunc-
tion or an adverb locatedat the beginningof a sen-
tence. These commas correspondto English com-
mas which are inserted right after a word such as
“however” and “furthermore”located at the begin-
ningof a sentence.
• JtJ0usvC#hwO%xyz#{C{5D
(However, I do notfeellike agreeingon it.)
In the analysis data, there existed 695 bunset-
sus whose rightmost morpheme is a conjunction
and which are located at the beginning of a sen-
tence. Among them, commas were inserted right
after 498 (71.65%) bunsetsus. In the case of bun-
setsuswhoserightmostmorphemeis an adverb, the
ratewas 30.97%(140/452).
3.6 CommasInsertedbetweenParallelWords
orPhrases
Commas have a function which makes clear sepa-
ration betweenparallel words or phrases. The fol-
lowing example shows commas separatingparallel
nouns.
895
• |J}~   3  0e 0  {   #!
"3 kU{/C {B{5  s  5D(The
UnitedNationsshouldplaya lot of rolesin a broad
range of fields, such as the global environment,
population, andfood.)
In this example, commas are inserted to separate
parallelnouns“  (environment),”“e (popula-
tion)”and“  (food)”.In English,therearecom-
mas whichperformthe same role. In fact, commas
were insertedbetween“environment”and “popula-
tion” and between “population”and “food” in the
translationof the above example. When bunsetsus
whose rightmost morpheme is a noun appear se-
quentially,therateofcommainsertionbetweensuch
bunsetsusis 59.39%(3,330/5,607).
Also, commas are inserted to separate parallel
phrases.In thefollowingexample,
•     s  0  > ;  kt;  Kh
   ; /k 0  @¡ 3¢(£⁄;¥ƒ
k JK§=%D(The menuis decidedby avoid-
ingthemenuthePrimeMinisterateontheprevious
night, and by consideringthe balance betweenthe
JapanesefoodandtheEuropeanfood.)
a commaisinsertedrightafterthebunsetsu“ /k
 (avoiding)”to make clearseparationbetweenthe
parallel phrases “h   ; /k (by avoid-
ingthemenu)”and“  @¡ 3¢(£⁄;¥ƒ
k JK(by consideringthe balance between the
Japanese food and the European food).” The rate
of commainsertionbetweentwo parallelphrasesis
79.89%(751/940).Thisis muchhigherthanthat of
bunsetsuboundaries,indicatingthatcommastendto
be insertedwhenphrasesareparalleled.
3.7 NumberofCharactersbetweenCommas
If there are too many commas at a short distance,
the sentence becomeshard to read. Therefore,the
number of charactersbetweencommasis expected
to be not too small. Also, becausea long sequence
of characters without a comma is generated if the
distance between commas is very long, the occur-
rence frequency of such sequencesof charactersis
consideredto be low.
Weinvestigatedthenumberofcharactersbetween
commas and its occurrence frequency. Figure 3
g1004
g1005g1004g1004
g1006g1004g1004
g1007g1004g1004
g1008g1004g1004
g1009g1004g1004
g1010g1004g1004
g1011g1004g1004
g1012g1004g1004
g1005 g1007 g1009 g1011 g1013g1005g1005g1005g1007g1005g1009g1005g1011g1005g1013g1006g1005g1006g1007g1006g1009g1006g1011g1006g1013g1007g1005g1007g1007g1007g1009g1007g1011g1007g1013g1008g1005g1008g1007
g381
g272g272
g437
g396
g286
g374
g272
g286
g3
g296g396
g286
g395
g437
g286
g374
g272g455
g374g437g373g271g286g396g3g381g296g3g272g346g258g396g258g272g410g286g396g400
Figure3: Numberof charactersbetweencommasandits
occurrencefrequency
shows the results of investigation. When the num-
ber of charactersbetweencommasis eitherlarge or
small,theoccurrencefrequency is low.
4 CommaInsertionMethod
In our method, a sentence, on which morphologi-
cal analysis, bunsetsu segmentation,clause bound-
aryanalysisanddependencyanalysishavebeenper-
formed, is considered the input. Our method de-
cideswhetheror not to inserta commaat eachbun-
setsu boundaryin an input sentence. Based on the
analysisresultsin Section3, our methodadoptsthe
bunsetsuboundariesas candidatepositionswherea
commais inserted. Our methodidentifiesthe most
appropriatecombinationamongall combinationsof
positionswherea commacan be inserted,by using
the probabilistic model. In this paper, input sen-
tenceswhichconsistof n bunsetsusare represented
by B = b
1
· · ·b
n, and the results of comma inser-
tion by R = r
1
· · ·r
n
. Here, r
i
is 1 if a comma
is insertedright after bunsetsu b
i, and 0 otherwise.
We indicatethe j-th sequenceof bunsetsuscreated
by dividing an input sentenceinto m sequencesas
L
j
= b
j
1
· · ·b
j
n
j
(1 ≤ j ≤ m), and then, r
j
k
=0if
1≤k < n
j, andr
j
k
=1if k = n
j
.
4.1 ProbabilisticModelforCommaInsertion
Whenan input sentenceB is provided,our method
identifies the comma insertion R that maximizes
the conditionalprobabilityP(R|B). Assumingthat
whetheror not to insert a commaright after a bun-
setsu is independent of other commas except the
896
Table4: Featuresusedforthemaximumentropy method
morphological therightmostindependentmorpheme,i.e. headword,(part-of-speechandinflectedform)and
information rightmostmorpheme(part-of-speech)of a bunsetsub
j
k
therightmostmorpheme(a surfaceform)of b
j
k
if therightmostmorphemeis a particle
thefirstmorpheme(part-of-speech)of b
j
k+1
commasinserted whetheror nota clauseboundaryexistsrightafterb
j
k
betweenclauses typeof a clauseboundaryrightafterb
j
k
if thereexistsa clauseboundary
commasindicating whetheror notb
j
k
dependson thenext bunsetsu
cleardependency whetherornotb
j
k
dependsonabunsetsulocatedafterthefinalbunsetsuoftheclauseincluding
relations thenext bunsetsuof b
j
k
whetheror notb
j
k
is dependedon by thebunsetsulocatedrightbeforeit
whetherornotthedependencystructureofasequenceofbunsetsusbetweenb
j
k
andb
j
1
isclosed
commasavoiding whetheror notboththerightmostmorphemeof b
j
k
andfirstmorphemeof b
j
k+1
arekanji
readingmistakesand characters
readingdifficulty whetheror not both the rightmostmorphemeof b
j
k
and first morphemeof b
j
k+1
are katakana
characters
commasindicating whetheror notthereexistsa clauseboundary“topicalizedelement-wa” rightafterb
j
k
andb
j
k
thesubject dependson thenext bunsetsu
whetheror not thereexists a clauseboundary“topicalizedelement-wa” right after b
j
k
and the
stringof charactersrightbeforeb
j
k
is “Gs(dewa)”
the numberof charactersin a phraseindicatingthe subject
5
if there exists a clauseboundary
“topicalizedelement-wa” rightafterb
j
k
whetherornota clauseboundary“topicalizedelement-wa” existsrightafterb
j
k
anda bunsetsu
whoserightmostmorphemeis a verbdependson themodifiedbunsetsuof b
j
k
commasinserted whetheror notb
j
k
appearsat thebeginningof a sentenceandits rightmostmorphemeis a
aftera conjunction conjunction
or adverb at the be-
ginningofasentence
whether or not b
j
k
appears at the beginning of a sentenceand its rightmostmorphemeis an
adverb
commasinserted whetheror notboththerightmostmorphemesof b
j
k
andb
j
k+1
arenouns
betweenparallel whetheror nota predicateat thesentenceendis dependedon by b
j
k
whoserightmost
wordsor phrases independentmorphemeis a verbandbyany of thebunsetsuswhicharelocatedafterb
j
k
andof
whichtherightmostindependentmorphemeis a verb
numberofcharacters oneof thefollowing4 categoriesif thenumberof charactersfromb
j
1
to b
j
k
is foundthere
fromb
j
1
to b
j
k
([num= 1], [2≤num≤3], [4≤num≤21],[22≤num])
one appearing immediately before that bunsetsu,
P(R|B) canbe calculatedas follows:
P(R|B) (1)
=P(r
1
1
=0,· · ·,r
1
n
1
−1
=0,r
1
n
1
=1,· · ·,
r
m
1
=0,···,r
m
n
m
−1
=0,r
m
n
m
=1|B)
∼
=P(r
1
1
=0|B)×· · ·
×P(r
1
n
1
−1
=0|r
1
n
1
−2
=0,· · ·,r
1
1
=0,B)
×P(r
1
n
1
=1|r
1
n
1
−1
=0,···,r
1
1
=0,B)×· · ·
×P(r
m
1
=0|r
m−1
n
m−1
=1,B)×· · ·
×P(r
m
n
m
−1
=0|r
m
n
m
−2
=0,· · ·,r
m
1
=0,r
m−1
n
m−1
=1,B)
×P(r
m
n
m
=1|r
m
n
m
−1
=0,· · ·,r
m
1
=0,r
m−1
n
m−1
=1,B)
where P(r
j
k
=1|r
j
k−1
=0,· · ·,r
j
1
=0,r
j−1
n
j−1
=
1,B)istheprobabilitythatacommaisinsertedright
after a bunsetsu b
j
k
when the sequence of bunset-
susB is providedandthe positionof j-th commais
identified.Similarly, P(r
j
k
=0|r
j
k−1
=0,· · ·,r
j
1
=
0,r
j−1
n
j−1
=1,B) is the probability that a comma
is not inserted right after a bunsetsu b
j
k
. These
probabilitiesareestimatedbythemaximumentropy
method. The result R which maximizesthe condi-
tional probabilityP(R|B) is regarded as the most
appropriate result of comma insertion, and calcu-
latedby dynamicprogramming.
897
4.2 FeaturesonMaximumEntropyMethod
To estimate P(r
j
k
=1|r
j
k−1
=0,· · ·,r
j
1
=
0,r
j−1
n
j−1
=1,B) andP(r
j
k
=0|r
j
k−1
=0,· · ·,r
j
1
=
0,r
j−1
n
j−1
=1,B) by the maximumentropy method,
weusedthefeaturesinTable4basedontheanalysis
describedin Section3.
5 Experiment
Toevaluatetheeffectivenessofourmethod,wecon-
ductedan experimentusinga Japanesetext corpus.
5.1 OutlineofExperiment
Astheexperimentaldata,weusedthenewspaperar-
ticles in the Kyoto Text Corpus version 4.0 (Kuro-
hashi and Nagao, 1998). We used the articlesfrom
January 14th to 17th as the test data. The training
datais sameas the analysisdata. Table5 shows the
size of the test data. Here, we used the maximum
entropy methodtool(Le,2008)withthe defaultop-
tionsexcept“-i 2000.”
In the evaluation,we obtainedthe recall,the pre-
cision and their harmonic mean, i.e., F-measure.
The recall and precisionare respectively definedas
follows.
recall=
#of correctly inserted commas
#of commas in thecorrect data
precision=
#of correctly inserted commas
#of inserted commas
In our research, to realize automatic comma in-
sertionwithhighquality, weanalyzedeachusageof
commasanddecidedthefeaturesfortheMEmethod
based on the analysis. To confirmthe effectiveness
of our features,we establishedthe baselinemethod
as a comparative method whereby commas are in-
sertedbytheMEmethodinwhichonlysimplemor-
phologicalinformationisused. Thebaselinemethod
uses the morphologicalinformationin Table 4 and
the informationof the rightmostmorpheme(a sur-
faceform)of a bunsetsuas features.
5.2 ExperimentalResults
Table 6 shows the experimentalresultsof the base-
line and our method. The recall and precision
were69.13%and 84.13%respectively, and we con-
firmedthatourmethodhadhigherperformancethan
Table5: Sizeof testdata
sentences 4,659
bunsetsus 46,511
characters 198,899
commas 6,549
characterspersentence 42.69
Table6: Experimentalresults
recall precision F-measure
our 69.13% 84.13% 75.90
method (4,527/6,549) (4,527/5,381)
baseline 51.38% 70.90% 59.58
(3,365/6,549) (3,365/4,746)
the baseline method. The percentageof sentences
wherein all commas were correctly inserted was
55.81%.
Figure 4 shows the comparisonbetween the re-
sults of our method and the baseline method. The
baselinemethodwasnotabletoinsertcommasright
afterthebunsetsu“MtVG5%>(arefloated)”or
“§currency1B{5k=(not decided)”but insertedcom-
masat unnaturalpositionssuchas between“'“%
(callinghimself)”and “«‹›fi>(the vice com-
mander).” On the other hand, our methodwas able
to insert commasproperlyat such bunsetsubound-
aries.
6 Discussion
6.1 ErrorAnalysis
Amongpositionswhere commasexisted in the test
data,thereexisted2,022positionswhereourmethod
did not insert commas. Among them, 862 were
clauseboundaries,andtheclauseboundary“topical-
ized element-wa” accountedfor 53.36% (460/862)
of them. There were a lot of clause boundariesof
the type “topicalizedelement-wa,” and the number
of commas inserted at such boundaries was large.
But, the rate of commainsertionitselfwas not very
high. We can say that the four featuresabout“topi-
calizedelement-wa” did not always work well. Ta-
5
Phrases indicatingthe subject is a sequence of bunsetsus
consistingof b
j
k
andallbunsetsusthatareconnectedto b
j
k
when
wetracetheirdependency relationshipin modifier-to-modifyee
direction.
898
g3267g12277g10885g2140g2123g2138g9660g3918g3225g14237g3526g14070g5121g6243g3690g14039g5121g2168g5310g4455g4148g3015g2285g5349g7231
g9524g3615g14268g5495g14039g2058g15104g5283g13413g4789g3667g3739g9510g2058g3128g5145g2146g4636g5255g4788g2893g7862g2173g2146g4001
g3667g2112g8075g2111g2183g2139g2104g2175g2112g2058g3667g6502g2140g2142g2175g6715g3498g2146g7135g10508g2163g2112g7924g2162g2173
g2142g2104g2131g2165g2058g12586g6746g2147g14260g11231g2059
g894g69g381g271g437g381g3g47g400g346g349g346g258g396g258g853g3g410g346g286g3g282g286g393g437g410g455g3g272g346g349g286g296g3g272g258g271g349g374g286g410g3g400g286g272g396g286g410g258g396g455g853g3g100g286g410g400g437g374g282g381
g47g449g258g364g437g374g349g853g3g410g346g286g3g373g258g455g381g396g3g381g296g3g47g460g437g373g381g272g349g410g455g3g349g374g3g94g346g349g373g258g374g286g853g60g437g374g349g381g44g258g410g381g455g258g373g258g853g3
g410g346g286g3g296g381g396g373g286g396g3g367g258g271g381g396g3g373g349g374g349g400g410g286g396g3g258g374g282g3g410g346g286g3g449g396g349g410g286g396g3g100g258g349g272g346g349g94g258g364g258g349g455g258g258g396g286g3
g296g367g381g258g410g286g282g3g258g400g3g410g346g286g3g272g258g374g282g349g282g258g410g286g853g346g381g449g286g448g286g396g853g3g400g349g374g272g286g3g410g346g286g3g296g396g258g373g286g449g381g396g364g3g381g296g3
g410g346g286g3g393g396g286g282g349g272g258g410g286g282g3g393g381g367g349g410g349g272g258g367g3g393g258g396g410g455g3g349g400g3g374g381g410g3g282g286g272g349g282g286g282g853g410g346g286g3g272g381g381g396g282g349g374g258g410g349g381g374g3
g373g258g364g286g400g3g367g349g410g410g367g286g3g346g286g258g282g449g258g455g856g3g895
g381g437g396g3g373g286g410g346g381g282g855
g3267g12277g10885g2140g2123g2138g9660g3918g3225g14237g3526g14070g5121g6243g3690g14039g5121g2168g5310g4455g4148g3015g2285g5349g7231
g9524g3615g14268g5495g14039g15104g5283g13413g4789g3667g3739g9510g2058g3128g5145g2146g4636g5255g4788g2893g7862g2173g2146g4001g3667
g2112g8075g2111g2183g2139g2104g2175g2112g3667g6502g2140g2142g2175g6715g3498g2146g7135g10508g2163g2112g7924g2162g2173g2142g2104
g2131g2165g12586g6746g2147g14260g11231g2059
g894g69g381g271g437g381g3g47g400g346g349g346g258g396g258g853g3g410g346g286g3g282g286g393g437g410g455g3g272g346g349g286g296g3g272g258g271g349g374g286g410g3g400g286g272g396g286g410g258g396g455g853g3g100g286g410g400g437g374g282g381
g47g449g258g364g437g374g349g853g3g410g346g286g3g373g258g455g381g396g3g381g296g3g47g460g437g373g381g272g349g410g455g3g349g374g3g94g346g349g373g258g374g286g60g437g374g349g381g44g258g410g381g455g258g373g258g853g3
g410g346g286g3g296g381g396g373g286g396g3g367g258g271g381g396g3g373g349g374g349g400g410g286g396g3g258g374g282g3g410g346g286g3g449g396g349g410g286g396g3g100g258g349g272g346g349g94g258g364g258g349g455g258g258g396g286g3
g296g367g381g258g410g286g282g3g258g400g3g410g346g286g3g272g258g374g282g349g282g258g410g286g346g381g449g286g448g286g396g853g3g400g349g374g272g286g3g410g346g286g3g296g396g258g373g286g449g381g396g364g3g381g296g3
g410g346g286g3g393g396g286g282g349g272g258g410g286g282g3g393g381g367g349g410g349g272g258g367g3g393g258g396g410g455g3g349g400g3g374g381g410g3g282g286g272g349g282g286g282g410g346g286g3g272g381g381g396g282g349g374g258g410g349g381g374g3
g373g258g364g286g400g3g367g349g410g410g367g286g3g346g286g258g282g449g258g455g856g3g895
g271g258g400g286g367g349g374g286g855
g2256g2269g2213g2219g2140g4001g2956g2175g3690g3990g3047g5121g2112g12210g2143g3615g2138g2115g2175g2112g2058g5127g14207g2146g3990
g3047g5121g2147g2905g6850g2059
g894g116g346g349g367g286g3g410g346g286g3g448g349g272g286g3g272g381g373g373g258g374g282g286g396g272g258g367g367g349g374g336g3g346g349g373g400g286g367g296g3g68g258g396g272g381g400g3g258g393g393g286g258g396g400g3
g349g374g3g393g437g271g367g349g272g853g3g258g374g3g258g272g410g437g258g367g3g272g381g373g373g258g374g282g286g396g3g349g400g3g437g374g272g286g396g410g258g349g374g856g895
g381g437g396g3g373g286g410g346g381g282g855
g2256g2269g2213g2219g2140g4001g2956g2175g2058g3690g3990g3047g5121g2112g12210g2143g3615g2138g2115g2175g2112g2058g5127g14207g2146
g3990g3047g5121g2147g2905g6850g2059
g894g116g346g349g367g286g3g410g346g286g3g448g349g272g286g3g272g381g373g373g258g374g282g286g396g853g272g258g367g367g349g374g336g3g346g349g373g400g286g367g296g3g68g258g396g272g381g400g3g258g393g393g286g258g396g400g3g349g374g3
g393g437g271g367g349g272g853g3g258g374g3g258g272g410g437g258g367g3g272g381g373g373g258g374g282g286g396g3g349g400g3g437g374g272g286g396g410g258g349g374g856g895
g271g258g400g286g367g349g374g286g855
Figure 4: Comparisonof the results of our method and
baselinemethod
ble 7 shows the results of comma insertion at the
clauseboundaries“topicalizedelement-wa.” While
thereexisted601 commasat suchboundariesin the
test data, only 141 commaswere insertedcorrectly.
We need to consider more effective features about
“topicalizedelement-wa.”
As for other cases, there existed 130 bunsetsu
boundariesbetween parallel words where commas
were not inserted. One example of such case is
shownbelow.
• correctdata:
fl –#†3‡·0 £ )0 ¶ •0‚„3
A V” ;»C0… 3‰  ¿£ `ƒcurrency1
OD(Put pork backfat, garlic, ginger and shredded
greenonionin a bowl, and add red bell peppersfor
color.)
Table 7: Resultof commainsertionat the clausebound-
aries“topicalizedelement-wa.”
recall precision F-measure
23.46% 59.49% 33.65
(141/601) (141/237)
• ourmethod:
fl –#†3‡· £ )0 ¶ •0‚„3A
 V” ;»C0… 3‰  ¿£ `ƒcurrency1OD
(Putporkbackfat garlic,gingerandshreddedgreen
onionina bowl,andaddredbellpeppersforcolor.)
In the correct data, a commawas insertedbetween
the bunsetsu“‡·(backfat)” and “ £ )(gar-
lic).”
If a commashouldbe insertedrightafterthebun-
setsu‘‘‡·(backfat),” thenumberofcharactersbe-
tweencommaswouldbecometoosmalltobejudged
as appropriateby the proposedmethod. So, the fea-
ture about the number of charactersbetween com-
mas may have had harmful effects there. On the
otherhand,a commawas insertedproperlybetween
the bunsetsu “ £ ) (garlic)” and “ ¶ •
(ginger).” This is because katakanacharactersap-
pearedsequentiallyin additionto appearingas par-
allelnouns.
6.2 UnnaturalCommaInsertion
When commas are inserted at obviously unnatural
positions, they have a major impact on the under-
standingof a sentenceby readers. Here, we inves-
tigated how many commashad been insertedat ob-
viouslyunnaturalpositionsby our method. For the
article on January 14th (217 sentences,2,349 bun-
setsus)in thetestdata,we examined47 commasin-
serted incorrectly. Three persons decided whether
or not the inserted commas were obviously unnat-
ural throughconsultations. Concretely, when all of
the threepersonsfelt that an insertedcommawould
make readers understand wrongly the meaning of
thesentence,thecommawasjudgedtobeobviously
unnatural.
Among47commas,4 commaswerejudgedobvi-
ously unnatural. This result shows that our method
is capableof insertingcommasat natural positions
on somelevel.
899
Table8: Comparisonwithhumanjudgement
recall precision F-measure
by human 78.30% 80.58% 79.42
(249/318) (249/309)
ourmethod 71.07% 82.78% 76.48
(226/318) (226/273)
6.3 ComparisonwithHumanJudgement
In our experiment, we evaluated the results of
commainsertionof our methodby comparingthem
with the correct data. However, the sufficient level
to be reachedby automaticcommainsertionis un-
certain. Here, we evaluated our method by com-
paringthem with the resultsof commainsertionby
anotherperson. By using the same data as used in
the subsection6.2, we conductedan experimenton
commainsertionby an annotatorwho was familiar
withwritingJapanesedocuments.Table8showsthe
recall,the precisionand the F-measure.Thesecond
row shows the results of our method for the same
data. As the F-measureof the annotatorwas 79.42,
it turned out that comma insertion task was diffi-
cult even for humans. For F-measure,our method
achieved96.30%(76.48/79.42)oftheannotator’sre-
sult. Also,theprecisionof ourmethodwas 82.78%.
Althoughthe comma insertiontask is difficult, our
methodwas ableto properlyinsertcommas.
7 Conclusion
Thispaperproposeda methodforinsertingcommas
into Japanese texts. Our method appropriatelyin-
sertscommasbasedonthemachinelearningmethod
using such features as morphemes, dependencies
and clauseboundaries. An experimentby usingthe
Kyoto Text Corpus (Kurohashi and Nagao, 1998)
showed an F-measureof 75.90, and we confirmed
theeffectivenessof ourmethod.
The analysis of the experimentalresults showed
that our method cannot insert commas of the par-
ticular usage. As a future work, it is necessary to
find more useful featuresfor commasof this usage
andimprove therecallof ourmethod.Also,wewill
examine“commasemphasizingthe adjacentword”
whichwerenotincludedin ourtargets.
Acknowledgments
This researchwas partiallysupportedby the Grant-
in-Aidsfor ScientificResearch(B) (No. 22300051)
and Young Scientists(B) (No. 21700157),and by
the ContinuationGrants for Young Researchersof
TheAsahiGlassFoundation.
References
Heidi Christensen,Yoshihiko Gotoh, and Steve Renals.
2001. Punctuationannotationusingstatisticalprosody
models. InProceedingsofISCAWorkshoponProsody
in Speech Recognitionand Understanding, pages35–
40.
Yuqing Guo, Haifeng Wang, and Josef van Genabith.
2010. A linguisticallyinspired statistical model for
Chinese punctuationgeneration. ACM Transactions
on AsianLanguage InformationProcessing, 9(2):6:1–
6:27.
Yoshihiko Hayashi. 1992. A three-level revision model
for improving Japanese bad-styled expressions. In
Proceedingof 14thInternationalConferenceon Com-
putationalLinguistics, pages665–671.
Katsuichi Honda. 1982. Nihongo no sakubun gijutsu
(Japanesewritingskill). AsahiShimbun Publications
Inc. (InJapanese).
TakashiInukai. 2002. Mojihyoukitankyuhou(Methodof
questioningcharacters and notations). AsakuraPul-
ishingCo.,Ltd. (InJapanese).
Hideki Kashiokaand Takehiko Maruyama. 2004. Seg-
mentation of semantic unit in Japanese monologue.
In Proceedingsof InternationalConferenceonSpeech
Language TechnologyandOrientalCOCOSDA, pages
87–92.
Ji-hwan Kim and P. C. Woodland. 2001. The use of
prosodyin a combinedsystemfor punctuationgener-
ation and speech recognition. In Proceedingsof 7th
EuropeanConference on Speech Communicationand
Technology, pages2757–2760.
Sadao Kurohashi and Makoto Nagao. 1998. Building
a Japaneseparsedcorpuswhileimprovingthe parsing
system. In Proceedingsof 1st InternationalConfer-
ence on Language Resources and Evaluation, pages
719–724.
ZhangLe. 2008. Maximumentropy modelingtoolkitfor
python and c++. http://homepages.inf.ed.
ac.uk/s0450736/maxenttoolkit.html.
[Online;accessed1-March-2008].
Yang Liu, Elizabeth Shriberg, Andreas Stolcke, Dustin
Hillard,MariOstendorf,and MaryHarper. 2006. En-
richingspeechrecognitionwithautomaticdetectionof
900
sentence boundaries and disfluencies. IEEE Trans-
actions on Audio, Speech, and Language Processing,
14(5):1526–1540.
Tohru Shimizu, Satoshi Nakamura, and Tatsuya Kawa-
hara. 2008. Effect of punctuationmarks for speech
translationunit boundarydetection. IEICE technical
report.Speech, 108(338):127–131.(InJapanese).
Shogakukan’s editiorial department. 2007. kutoten,
kigou,hugoukatuyoujiten(dictionaryof punctuations
andsymbols). Shogakukan. (InJapanese).
Eiji Suzuki,ShizuoShimada,KunioKondo,and Hisashi
Sato. 1995. Automaticrecognitionof optimalpunc-
tuation in Japanese documents. In Proceedings of
50thNationalConventionof IPSJ, 50(3):185–186.(In
Japanese).
Michael White and Rajakrishnan Rajkumar. 2008.
A more precise analysis of punctuation for broad-
coverage surface realizationwith CCG. In Proceed-
ings of Workshop on Grammar Engineering Across
Frameworks, pages17–24.
901

